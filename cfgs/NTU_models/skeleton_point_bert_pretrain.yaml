# NTU RGB+D 骨架Point-BERT预训练配置
# 阶段2：基于dVAE码本的Point-BERT预训练

optimizer: {
  type: AdamW,
  kwargs: {
    lr: 0.0002,
    weight_decay: 0.05,
    betas: [0.9, 0.999]
  }
}

scheduler: {
  type: CosLR,
  kwargs: {
    epochs: 300,
    initial_epochs: 10,
    warming_up_init_lr: 0.00002
  }
}

# 数据集配置
dataset: {
  train: { 
    _base_: cfgs/dataset_configs/NTU_augmented.yaml, 
    others: {
      subset: 'train', 
      npoints: 512,
      points_per_bone: 21,
      action_filter: 'dvae',
      augment: true,
      whole: false
    }
  },
  val: { 
    _base_: cfgs/dataset_configs/NTU_augmented.yaml, 
    others: {
      subset: 'val', 
      npoints: 512,
      points_per_bone: 21,
      action_filter: 'dvae',
      augment: false,
      whole: false
    }
  }
}

# Point-BERT模型配置
model: {
  NAME: Point_BERT,
  group_size: 32,
  num_group: 16,
  encoder_dims: 384,
  decoder_dims: 384,
  
  # Transformer配置
  trans_dim: 384,
  depth: 12,
  drop_path_rate: 0.1,
  num_heads: 6,
  
  # 掩码策略
  mask_ratio: 0.6,
  mask_type: 'rand',
  
  # dVAE相关
  dvae_checkpoint: './experiments/ntu_skeleton_dvae_pretrain/ckpt-best.pth',
  group_size: 32,
  num_group: 16
}

# 训练设置
total_bs: 64
step_per_update: 1
max_epoch: 300
use_gpu: true
val_freq: 10
num_workers: 4
seed: 2021

# 预训练任务配置
pretrain_task: {
  type: 'masked_point_modeling',
  mask_ratio: 0.6,
  loss_type: 'cdl1'  # Chamfer Distance L1
}

# 预训练阶段标识
stage: "point_bert_pretrain"
task: "masked_point_modeling"
experiment_name: "ntu_skeleton_point_bert_pretrain"
description: "基于NTU RGB+D骨架数据的Point-BERT预训练"

# 依赖检查
dependencies: {
  dvae_checkpoint: './experiments/ntu_skeleton_dvae_pretrain/ckpt-best.pth',
  required_stage: 'dvae_pretrain'
}
